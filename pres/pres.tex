\documentclass{beamer}
\usetheme{CambridgeUS}
\usepackage[absolute,overlay]{textpos}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{animate}
\usepackage{calc}
\newcounter{m} % Number of sides of the polygon
\setcounter{m}{2}
\newcounter{c} % Internal Control Counter
\usepackage{hyperref}
\hypersetup{pdfpagemode=FullScreen}
\usefonttheme{professionalfonts}
\usepackage{smartdiagram}
\usepackage{times}
\usepackage{changepage}
\providecommand\thispdfpagelabel[1]{}

\usepackage{amssymb}
\usetikzlibrary{arrows.meta}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{verbatim}
\usetikzlibrary{arrows,shapes}
\usepackage{array,multirow,makecell}
\setcellgapes{1pt}
\makegapedcells
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash }b{#1}}
\newcolumntype{L}[1]{>{\raggedright\arraybackslash }b{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash }b{#1}}
\tikzset{
pil/.style={
           ->,
           thick,
           shorten <=2pt,
           shorten >=2pt,}}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{arrows,positioning}
\usepackage{smartdiagram}
\usepackage{metalogo}
\setbeamertemplate{headline}{}
\tikzstyle{vecArrow} = [thick, decoration={markings,mark=at position
   1 with {\arrow[semithick]{open triangle 60}}},
   double distance=1.4pt, shorten >= 5.5pt,
   preaction = {decorate},
   postaction = {draw,line width=1.4pt, white,shorten >= 4.5pt}]
\tikzstyle{innerWhite} = [semithick, white,line width=1.4pt, shorten >= 4.5pt]

\setbeamertemplate{navigation symbols}{}
\makeatletter
\setbeamertemplate{footline}
{
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
    \usebeamerfont{author in head/foot} {Onur, Bastien, Paul, Florent}
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
    \usebeamerfont{title in head/foot}\insertsection
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,right]{date in head/foot}%
    \usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
    \insertframenumber{} / \inserttotalframenumber\hspace*{2ex} 
  \end{beamercolorbox}}%
  \vskip0pt%
}
\makeatother

\newcommand{\margin}{0\paperwidth}


%\beamersetrightmargin{\margin}
%\beamersetleftmargin{\margin}

\newcommand\Wider[2][3em]{%
\makebox[\linewidth][c]{%
  \begin{minipage}{\dimexpr\textwidth+#1\relax}
  \raggedright#2
  \end{minipage}%
  }%
}



\usetikzlibrary{shapes,snakes}

%\input{tex_files/ZZ_newcommand1}

\definecolor{myblue}{RGB}{79,129,189}

\tikzset{%
  >={Latex[width=2mm,length=2mm]},
  % Specifications for style of nodes:
            base/.style = {rectangle, rounded corners, draw=black,
                           minimum width=4cm, minimum height=1cm,
                           text centered, font=\normalfont},
  activityStarts/.style = {base, fill=blue!30},
       startstop/.style = {base, fill=red!30},
    activityRuns/.style = {base, fill=green!30},
         process/.style = {base, minimum width=2.5cm, fill=orange!15,
                           font=\normalfont},
}



\begin{document}

\bibliography{abbrev3,crypto,add,add2}


\title{\bf Using Netzob for protocol reverse engineering }   
\author{Onur CATAKOGLU , Bastien DROUOT,\\ Paul GERMOUTY, Florent TARDIF\\~\\ Advisor: Fr\'{e}d\'{e}ric GUIH\'{E}RY} 
\date{November 2, 2017} 


\logo{%
    %\includegraphics[width=2cm,height=1cm,keepaspectratio]{zoby.png}%
    \includegraphics[width=2cm,height=1cm,keepaspectratio]{redocsFullColor-W.png}~%
   
}

%\logo{\includegraphics[height=5mm]{limoges.jpg}}

\begin{frame}

	\titlepage
	\begin{tikzpicture}[remember picture,overlay]
    \node[xshift=2cm,yshift=2cm] at (current page.south west) {\includegraphics[scale=0.05]{onur.jpg}};
    \node[xshift=4cm,yshift=2cm] at (current page.south west) {\includegraphics[scale=0.1]{bastien.png}};
    \node[xshift=6cm,yshift=2cm] at (current page.south west) {\includegraphics[scale=0.1]{florent.png}};
    \node[xshift=8cm,yshift=2cm] at (current page.south west) {\includegraphics[scale=0.1]{xlim.png}};
    \node[xshift=10cm,yshift=2cm] at (current page.south west) {\includegraphics[scale=0.05]{amossys.png}};
\end{tikzpicture}

%\begin{center}
%Supervised By Fr\'{e}d\'{e}ric Guih\'{e}
%\end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}

\begin{frame}{\bf Objective}

  Our task: adopting an active approach to protocol reverse engineering

  ~

  \begin{block}{Attack Model}
    \begin{itemize}
      \item no previous knowledge of the protocol (no documentation)
      \item access to a client implementation
      \item passive monitoring / active querying of the server
    \end{itemize}
  \end{block}

\end{frame}

\begin{frame}{\bf \textbf{Netzob}}
  \em{Netzob}: a framework helping the reverser to discover the protocol
 
  ~

  Provides the following features:

  \begin{itemize}
    \item abstraction of requests with a symbolic representation with fields
    \item tools to send messages to the server
    \item functions to split messages in fields:\\
    \quad\quad$\rightarrow$ \texttt{splitStatic}: use static messages parts\\
    \quad\quad$\rightarrow$ \texttt{splitAligned}: detect moving reccurrent parts\\
    \quad\quad$\rightarrow$ \texttt{splitDelimiter}: use manually entered delimiters
  \end{itemize}

\end{frame}


\begin{frame}{\bf Example 1}
  Analyse with \texttt{SplitAligned}
  ~

  \tiny\input{splitaligned.tex}
\end{frame}

\begin{frame}{\bf Example 2}
  Analyse with \texttt{SpliStatic}

  ~

  \tiny\input{splitstatic.tex}
\end{frame}

\begin{frame}{\bf Example 3}
  Analyse with \texttt{SplitDelimiter} with delimiter \texttt{\symbol{92}x02}

  ~

  \tiny\input{splitdelim.tex}
\end{frame}

\section{RoadMap}

\begin{frame}{\bf Roadmap}

%\begin{frame}
\begin{center}
\scalebox{0.9}{
\begin{tikzpicture}[node distance=1.5cm,
    every node/.style={fill=white, font=\sffamily}, align=center]

\node (Input)             [activityStarts]              {Input};

\node (SI)     [process, below of=Input]          {Select messages};

\node (DF)     [process, below of=SI]          {Delimit fields};

\node (CF)     [process, below of=DF]          {Characterize fields};

\node (AI)     [process, below of=CF]          {Assess the impact of the fields};

\node (VH)     [process, below of=AI]          {Demonstration};

\draw[->]             (Input) -- (SI);
\draw[->]             (SI) -- (DF);
\draw[->]             (DF) -- (CF);
\draw[->]             (CF) -- (AI);
\draw[->]             (AI) -- (VH);
  \end{tikzpicture}}
  \end{center}



\end{frame}



\begin{frame}{\bf Sorting Input}
\begin{center}
\scalebox{0.9}{
\begin{tikzpicture}[node distance=1.5cm,
    every node/.style={fill=white, font=\sffamily}, align=center]

\node (Input)             [activityStarts]              {Input};

\node (SI)     [startstop, below of=Input]          {Select messages};

\node (DF)     [process, below of=SI]          {Delimit fields};

\node (CF)     [process, below of=DF]          {Characterize fields};

\node (AI)     [process, below of=CF]          {Assess the impact of the fields};

\node (VH)     [process, below of=AI]          {Demonstration};

\draw[->]             (Input) -- (SI);
\draw[->]             (SI) -- (DF);
\draw[->]             (DF) -- (CF);
\draw[->]             (CF) -- (AI);
\draw[->]             (AI) -- (VH);
  \end{tikzpicture}}
  \end{center}
\end{frame}



\begin{frame}{\bf Divide and Conquer}
\begin{center}
\includegraphics[scale=0.25]{Sorting_by_type.png}
\end{center}
\end{frame}


%\section{Basic Tools}
%\begin{frame}
%
%	\tableofcontents[currentsection]
%\end{frame}
%
%\begin{frame}
%getting pcap
%
%sorting pcap
%
%verify cruciality
%
%verify timeout
%
%send 1 message
%...
%
%
%\end{frame}
\begin{frame}{\bf Delimit fields}
\begin{center}
\scalebox{0.9}{
\begin{tikzpicture}[node distance=1.5cm,
    every node/.style={fill=white, font=\sffamily}, align=center]

\node (Input)             [activityStarts]              {Input};

\node (SI)     [process, below of=Input]          {Select messages};

\node (DF)     [startstop, below of=SI]          {Delimit fields};

\node (CF)     [process, below of=DF]          {Characterize fields};

\node (AI)     [process, below of=CF]          {Assess the impact of the fields};

\node (VH)     [process, below of=AI]          {Demonstration};

\draw[->]             (Input) -- (SI);
\draw[->]             (SI) -- (DF);
\draw[->]             (DF) -- (CF);
\draw[->]             (CF) -- (AI);
\draw[->]             (AI) -- (VH);
  \end{tikzpicture}}
  \end{center}
\end{frame}

%
\begin{frame}{\bf Delimiters}
\begin{itemize}
\item Statistical research

\bigskip

\item Active verification

\bigskip

\item Double elimination
\end{itemize}

\end{frame}

\begin{frame}{\bf Using delimiters}
    Analyse with \texttt{Delim}

  ~

  \tiny\input{newdelim.tex}
\end{frame}

\begin{frame}{\bf SmartAligned}
  Analyse with \texttt{SmartAligned}

  ~

  \tiny\input{shapingsplitalign.tex}
\end{frame}



\begin{frame}{\bf Characterizing Fields}
\begin{center}
\scalebox{0.9}{
\begin{tikzpicture}[node distance=1.5cm,
    every node/.style={fill=white, font=\sffamily}, align=center]

\node (Input)             [activityStarts]              {Input};

\node (SI)     [process, below of=Input]          {Select messages};

\node (DF)     [process, below of=SI]          {Delimit fields};

\node (CF)     [startstop, below of=DF]          {Characterize fields};

\node (AI)     [process, below of=CF]          {Assess the impact of the fields};

\node (VH)     [process, below of=AI]          {Demonstration};

\draw[->]             (Input) -- (SI);
\draw[->]             (SI) -- (DF);
\draw[->]             (DF) -- (CF);
\draw[->]             (CF) -- (AI);
\draw[->]             (AI) -- (VH);
  \end{tikzpicture}}
  \end{center}
\end{frame}

\begin{frame}{\bf Characterizing Fields}
  \begin{itemize}
    \item Static / Dynamic

    \bigskip

    \item Txt / Bin

  \end{itemize}

  \begin{itemize}
  \item Change a static field

  $\Rightarrow$ get no error/timeout $\rightarrow$ False H
  
  \bigskip

  \item Put binary value in a text field
  
  $\Rightarrow$ get no error/timeout $\rightarrow$ False H
  \end{itemize}
  
\end{frame}



\begin{frame}{\bf Assess the impact of the fields}
\begin{center}
\scalebox{0.9}{
\begin{tikzpicture}[node distance=1.5cm,
    every node/.style={fill=white, font=\sffamily}, align=center]

\node (Input)             [activityStarts]              {Input};

\node (SI)     [process, below of=Input]          {Select messages};

\node (DF)     [process, below of=SI]          {Delimit fields};

\node (CF)     [process, below of=DF]          {Characterize fields};

\node (AI)     [startstop, below of=CF]          {Assess the impact of the fields};

\node (VH)     [process, below of=AI]          {Demonstration};

\draw[->]             (Input) -- (SI);
\draw[->]             (SI) -- (DF);
\draw[->]             (DF) -- (CF);
\draw[->]             (CF) -- (AI);
\draw[->]             (AI) -- (VH);
  \end{tikzpicture}}
  \end{center}
\end{frame}

\begin{frame}{\bf Fields Order Importance}
\begin{center}
\includegraphics[scale=0.25]{swapFieldOrder.png}
\end{center}
\end{frame}

\begin{frame}{\bf Find Increment}
\begin{center}
\includegraphics[scale=0.3]{incrementation.png}
\end{center}
\end{frame}

\begin{frame}\frametitle{Stateless vs. Stateful}

  Stateful messages:
  \begin{itemize}
    \item depends on a global state (ex. authentication)
    \item require understanding of the session mechanism
  \end{itemize}

  ~

  Stateless messages: 
  \begin{itemize}
    \item returns the same responses
    \item does not have any session
  \end{itemize}

  ~

  \begin{block}{Detection}
    \begin{itemize}
      \item get a valid message
      \item replay the message several time
      \item same messages ? \begin{tabular}{ccc}YES &$\Rightarrow$& stateless\\NO &$\Rightarrow$& stateful\end{tabular}
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}{Fuzzing}

  Impact of modifications in the messages

  \begin{itemize}
    \item identify the type of the fields (static or dynamic)
    \item take a message with a dynamic field
    \item query the server with both the original and modified message
    \item calculate the difference between the two
  \end{itemize}

  \begin{center}\includegraphics[scale=0.4]{modify.png}\end{center}

\end{frame}

\begin{frame}{\bf Verifying Hypothesis}
\begin{center}
\scalebox{0.9}{
\begin{tikzpicture}[node distance=1.5cm,
    every node/.style={fill=white, font=\sffamily}, align=center]

    \node (Input)  [activityStarts]          {Input};
    \node (SI)     [process, below of=Input] {Select messages};
    \node (DF)     [process, below of=SI]    {Delimit fields};
    \node (CF)     [process, below of=DF]    {Characterize fields};
    \node (AI)     [process, below of=CF]    {Assess the impact of the fields};
    \node (VH)     [startstop, below of=AI]  {Demonstration};
    \draw[->]      (Input) -- (SI);
    \draw[->]      (SI) -- (DF);
    \draw[->]      (DF) -- (CF);
    \draw[->]      (CF) -- (AI);
    \draw[->]      (AI) -- (VH);
  \end{tikzpicture}}
  \end{center}
  
  \end{frame}
  


\section{Conclusion}

\begin{frame}{\bf Personal Experience}
\begin{itemize}
\item Good Points
\begin{itemize}
\item Team cohesion 
\item Interest for the subject
\item Many ideas
\item Late organization
\end{itemize}

\item Points to Improve 
\begin{itemize}
\item Extend the time allowed for playing with tools
\item Early organization 
\item Limiting the area of research
\end{itemize}
\end{itemize}


\end{frame}

\section{Future Work}


\begin{frame}{\bf Improvements}

\begin{itemize}
    \item Apply \texttt{CrucialSearch} on larger scale
    \item Dependency of fields\\
    \begin{center}\includegraphics[scale=0.5]{relations.png}\end{center}
    \item Determinate boundaries
\end{itemize}
\end{frame}

\end{document}
